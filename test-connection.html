<!DOCTYPE html>
<html>
<head>
    <title>Azure Connection Test</title>
</head>
<body>
    <h1>Azure Blob Storage Connection Test</h1>
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        function log(message) {
            console.log(message);
            results.innerHTML += '<div>' + message + '</div>';
        }
        
        // Test Azure connection
        const accountName = "aurelianwarestorage";
        const containerName = "security-events";
        const sasToken = "sp=racwdl&st=2025-10-11T06:08:53Z&se=2026-01-02T14:23:53Z&spr=https&sv=2024-11-04&sr=c&sig=BCl1ObQ4J24d7zppHXnYCDr044Egra50fYHknnHB1io%3D";

        const baseUrl = `https://${accountName}.blob.core.windows.net/${containerName}`;
        const listUrl = `${baseUrl}?comp=list&restype=container&${sasToken}`;

        log("=== Azure Blob Storage Connection Test ===");
        log("Account: " + accountName);
        log("Container: " + containerName);
        log("List URL: " + listUrl);
        log("");
        log("Testing connection...");

        fetch(listUrl)
            .then(response => {
                log("‚úÖ Response received!");
                log("Status: " + response.status + " " + response.statusText);
                
                if (response.status === 200) {
                    log("üéâ SUCCESS: Container access works!");
                    return response.text();
                } else if (response.status === 404) {
                    log("‚ùå ERROR: Container 'security-events' does not exist");
                    log("üìã SOLUTION: Create the container in Azure Portal");
                    throw new Error("Container not found");
                } else if (response.status === 403) {
                    log("‚ùå ERROR: Access denied - check SAS token permissions");
                    throw new Error("Access denied");
                } else {
                    log("‚ùå ERROR: Unexpected status " + response.status);
                    return response.text();
                }
            })
            .then(text => {
                if (text) {
                    log("üìÑ Response content (first 200 chars):");
                    log(text.substring(0, 200) + "...");
                }
            })
            .catch(error => {
                log("‚ùå FETCH ERROR: " + error.message);
                if (error.message.includes('CORS')) {
                    log("üîß SOLUTION: Configure CORS in Azure Storage Account");
                } else if (error.message.includes('Failed to fetch')) {
                    log("üîß SOLUTION: This might be a CORS issue or network problem");
                }
            });
    </script>
</body>
</html>